export default(async(e,t)=>{if("insert"===e){let[n,r,l,i]=t,_=n.length;if(_<2)return!1;let a=11===n[1].nodeType;if(!isElem(n[1])&&!a||!r(n[0]))return!1;let f=_>2?n[2]:null,u=_>3&&n[3];(!0===f||!1===f)&&(u=f,f=null),f=l(f);let o="";if(a&&((o=document.createElement("div")).appendChild(n[1]),o=o.innerHTML),u&&isElem(n[0]))return a?n[0].insertAdjacentHTML(f,o):n[0].insertAdjacentElement(f,n[1]);{let c=[];return a?i(n[0]).forEach(e=>e.insertAdjacentHTML(f,o)):(i(n[0]).forEach(e=>{let t=n[1].cloneNode(!0);e.insertAdjacentElement(f,t),c.push(t)}),u&&n[1].remove()),!c.length||(isElem(n[0])?c[0]:c)}}if("replace"===e){let[s,d,h]=t,p=s.length;if(p<2||!d(s[0]))return!1;let m=p>2&&!0===s[2],E=h(s[1]),g=E.length;if(m&&isElem(s[0]))return s[0].replaceWith(...E),1===g?E[0]:E;{let T=[];return h(s[0]).forEach(e=>{let t=E.map(e=>e.cloneNode(!0));e.replaceWith(...t),T.push(t)}),m&&E.map(e=>e.remove()),isElem(s[0])?1===g?T[0][0]:T[0]:1===g?T.flat():T}}if("swap"===e){let w=t[0];if(w.length<2||!isElem(w[0])||!isElem(w[1])||w[0]===w[1])return!1;let L=w[0].$(".."),N=w[1].$("..");if(!L||!N)return!1;let O=[!1,!1];if(L===N){let[b,j]=w[0].compareDocumentPosition(w[1])&Node.DOCUMENT_POSITION_FOLLOWING?[w[0].$("<<")||null,w[1].$(">>")||null]:[w[1].$(">>")||null,w[0].$("<<")||null];O=[await $.insert(j||L,w[0],j?"before":"end",!0),await $.insert(b||L,w[1],b?"after":"begin",!0)]}else{let A=w[0].$(">>"),M=w[1].$(">>");O=[await $.insert(M||N,w[0],M?"before":"end",!0),await $.insert(A||L,w[1],A?"before":"end",!0)]}return!!isElem(O[0],O[1])&&O}});