export default(async(e,t,l)=>{if("get"===e){let[n,s,r,p,y,i]=l,u=s(t);if(n=r(p(n)),u){let f=y(t),o=f.map(e=>{let t=Object.keys(coreData.spy).filter(t=>coreData.spy[t].some(t=>t.element===e));return t.length>0?t:null});return o.length>0?isElem(t)?o[0]:o:null}if(n){let a=n.reduce((e,t)=>(e[t]=t in coreData.spy?coreData.spy[t].map(e=>e.element):null,e),{});return len(a)>0?n?.length>1?a:Object.values(a)[0]:null}{let m=Object.keys(coreData.spy).reduce((e,t)=>(e[t]=coreData.spy[t].map(e=>e.element),e),{});return len(m)?m:null}}if("has"===e){let[c,h,d,$,_,v]=l,g=h(t);return c=d($(c)),(!!g||!!c)&&(g?_(t).every(e=>Object.values(coreData.spy).some(t=>t.some(t=>t.element===e))):c.every(e=>e in coreData.spy))}if("on"===e){let[E,w,k,O,P,b]=l;if(!w(t))return!1;let x=[];if(x.push(...E.filter(e=>!isObj(e)).flatMap(e=>toArr(e))),!(x=k(O(x))))return!1;let M=P(t),j=E.find(e=>hasObj(e))||b;return x.forEach(e=>{coreData.spy[e]||=[],M.forEach(t=>{coreData.spy[e].push({element:t,mutation:new MutationObserver(l=>{l.forEach(l=>{l.it=t,component[e](l)})})}),coreData.spy[e].slice(-1)[0].mutation.observe(t,j)})}),!0}if("off"===e){let[q,z,A,B,C,D]=l;q=A(B(q));let F=z(t),G=(e=!0)=>{for(let t in coreData.spy)coreData.spy.hasOwnProperty(t)&&(!e||q.includes(t))&&(coreData.spy[t].forEach(e=>{e.mutation.disconnect()}),delete coreData.spy[t])},H=(e=!0)=>{let l=C(t);for(let n in coreData.spy)coreData.spy.hasOwnProperty(n)&&(!e||q.includes(n))&&(coreData.spy[n]=coreData.spy[n].filter(e=>!l.includes(e.element)||(e.mutation.disconnect(),!1)),len(coreData.spy[n])||delete coreData.spy[n])};q&&F?H(!0):q?G(!0):F?H(!1):G(!1)}});